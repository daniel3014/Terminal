<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Terminal</title>

<style>
:root {
  --glass: rgba(255,255,255,0.55);
  --border: rgba(255,255,255,0.35);
  --blur: blur(22px);
  --shadow: 0 20px 40px rgba(0,0,0,0.12);
  --grid: 80px;
}

* {
  box-sizing: border-box;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
}

body {
  margin: 0;
  min-height: 100vh;
  background: linear-gradient(135deg, #e6f1ff, #cfe4ff);
  padding: 30px 16px;
}

/* GRID VISUAL (ALINHADO AO APP) */
.app.edit-mode::before {
  content: "";
  position: absolute;
  inset: 0;
  background-image:
    linear-gradient(to right, rgba(0,0,0,.08) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(0,0,0,.08) 1px, transparent 1px);
  background-size: var(--grid) var(--grid);
  pointer-events: none;
}

/* APP */
.app {
  position: relative;
  max-width: 1100px;
  margin: auto;
  min-height: 800px;
}

/* WIDGET */
.widget {
  position: absolute;
  width: 280px;
  background: var(--glass);
  backdrop-filter: var(--blur);
  border: 1px solid var(--border);
  border-radius: 26px;
  box-shadow: var(--shadow);
  padding: 22px;
  user-select: none;
  transition: box-shadow .2s;
}

.edit-mode .widget {
  cursor: grab;
  animation: wiggle .35s ease-in-out infinite alternate;
}

@keyframes wiggle {
  from { transform: rotate(-0.4deg); }
  to   { transform: rotate(0.4deg); }
}

/* CLOCK */
.clock {
  width: 560px;
  text-align: center;
}

.clock-time { font-size: 64px; }
.clock-date { opacity: .6; }

/* WEATHER */
.weather strong { font-size: 28px; }

/* FORECAST */
.forecast {
  display: flex;
  justify-content: space-between;
}

/* THEME SLIDER ‚Äî EXATAMENTE COMO ANTES */
.theme-slider {
  position: fixed;
  top: 20px;
  right: 20px;
  width: 160px;
  padding: 10px;
  border-radius: 30px;
  background: var(--glass);
  backdrop-filter: var(--blur);
  border: 1px solid var(--border);
  z-index: 10;
}

.track {
  position: relative;
  height: 36px;
  background: rgba(255,255,255,0.4);
  border-radius: 18px;
}

.thumb {
  position: absolute;
  top: 4px;
  left: 60px;
  width: 28px;
  height: 28px;
  border-radius: 50%;
  background: white;
  box-shadow: var(--shadow);
}

.labels {
  display: flex;
  justify-content: space-between;
  font-size: 14px;
  margin-top: 6px;
  opacity: .7;
}
</style>
</head>

<body>

<!-- SLIDER -->
<div class="theme-slider">
  <div class="track">
    <div class="thumb"></div>
  </div>
  <div class="labels">
    <span>‚òÄÔ∏è</span>
    <span>AUTO</span>
    <span>üåô</span>
  </div>
</div>

<div class="app" id="app">

  <div class="widget weather" style="left:0;top:0">
    <strong>23¬∞C ‚òÄÔ∏è</strong><br>
    Sensa√ß√£o 25¬∞ ¬∑ Chuva 10%
  </div>

  <div class="widget clock" style="left:320px;top:0">
    <div class="clock-time" id="time"></div>
    <div class="clock-date" id="date"></div>
  </div>

  <div class="widget forecast" style="left:0;top:200px">
    <span>‚òÄÔ∏è 24¬∞</span>
    <span>üåßÔ∏è 22¬∞</span>
    <span>‚õÖ 23¬∞</span>
  </div>

  <div class="widget" style="left:320px;top:280px">
    Widget futuro do Jarvis
  </div>

</div>

<script>
/* CLOCK */
function updateClock() {
  const now = new Date();
  time.textContent = now.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"});
  date.textContent = now.toLocaleDateString("pt-BR",{weekday:"long",day:"numeric",month:"long"});
}
updateClock();
setInterval(updateClock,1000);

/* EDIT MODE */
const app = document.getElementById("app");
let edit = false;
let holdTimer;

function enterEdit() {
  edit = true;
  app.classList.add("edit-mode");
}

function exitEdit() {
  edit = false;
  app.classList.remove("edit-mode");
}

document.addEventListener("dblclick", e => {
  if (e.target.closest(".widget")) enterEdit();
});

document.addEventListener("mousedown", e => {
  if (!e.target.closest(".widget")) exitEdit();
});

/* PRESS & HOLD */
document.addEventListener("mousedown", e => {
  if (!e.target.closest(".widget")) return;
  holdTimer = setTimeout(enterEdit, 500);
});

document.addEventListener("mouseup", () => clearTimeout(holdTimer));

/* DRAG + SNAP */
const grid = 80;
let active = null, offsetX = 0, offsetY = 0;

document.addEventListener("mousedown", e => {
  if (!edit) return;
  const w = e.target.closest(".widget");
  if (!w) return;

  active = w;
  const rect = w.getBoundingClientRect();
  const parent = app.getBoundingClientRect();

  offsetX = e.clientX - rect.left;
  offsetY = e.clientY - rect.top;

  document.addEventListener("mousemove", move);
  document.addEventListener("mouseup", drop);
});

function move(e) {
  if (!active) return;
  const parent = app.getBoundingClientRect();
  active.style.left = e.clientX - parent.left - offsetX + "px";
  active.style.top  = e.clientY - parent.top  - offsetY + "px";
}

function collides(x,y,w,h,el){
  return [...document.querySelectorAll(".widget")].some(o=>{
    if(o===el) return false;
    return !(x+w<o.offsetLeft || x>o.offsetLeft+o.offsetWidth ||
             y+h<o.offsetTop  || y>o.offsetTop+o.offsetHeight);
  });
}

function drop() {
  if (!active) return;

  let x = Math.round(active.offsetLeft / grid) * grid;
  let y = Math.round(active.offsetTop  / grid) * grid;

  while (collides(x,y,active.offsetWidth,active.offsetHeight,active)) {
    y += grid;
  }

  active.style.left = x + "px";
  active.style.top  = y + "px";

  active = null;
  document.removeEventListener("mousemove", move);
  document.removeEventListener("mouseup", drop);
}
</script>

</body>
</html>
